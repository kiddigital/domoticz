server.modules = (
        "mod_indexfile",
        "mod_access",
        "mod_alias",
        "mod_redirect",
        "mod_rewrite",
        "mod_setenv",
        "mod_proxy",
        "mod_magnet"
)
mimetype.assign = (
  ".html" => "text/html", 
  ".txt" => "text/plain",
  ".css" => "text/css",
  ".js" => "text/javascript",
  ".json" => "application/json;charset=UTF-8",
  ".jpg" => "image/jpeg",
  ".png" => "image/png" 
)

server.document-root = "/home/vagrant/domoticz/www/" 

server.port = 8888

index-file.names = ( "index.html" )

url.rewrite-once = ( 
  "^\/acttheme\/(.*)$" => "/styles/default/$1",
  "^\/json.htm(\?(.*))?" => "/faked/${esc:2}.json"
)

$HTTP["url"] =~ ".js" {
  url.rewrite-if-not-file = ( "^\/js\/(.*)\.js$" => "/js/$1.js.gz" )
  #setenv.add-response-header = ( "Content-Encoding" => "gzip" )
  magnet.attract-physical-path-to = ( "/home/vagrant/domoticz/test/lighttpd_gzippedjs.lua" )
}

proxy.header = ( "map-urlpath" => 
    (
      "/api/v2/"  => "/"
    )
  )

proxy.server = ( "/api/v2" =>
    ( "prism" =>
      (
        "host" => "10.0.2.15",
        "port" => "4010"
      )
    ),
  "/" =>
    ( "therest" =>
      (
        "host" => "10.0.2.15",
        "port" => "8080
      )
  )

#debug.log-request-handling = "enable"
debug.log-request-header-on-error = "enable"
#debug.log-request-header = "enable"
#debug.log-response-header = "enable"
debug.log-file-not-found = "enable"
#debug.log-condition-handling = "enable"
